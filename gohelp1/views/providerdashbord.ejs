<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Service Provider Dashboard</title>
</head>
<body>
  <h1>Service Provider Dashboard</h1>

  <a href="/gohelp/<%= employmail %>">go to your profile</a>
  <a href="/employlogin/<%= employmail %>">show order history</a>

  <% for (let pro of provides) { %>
    <% if (pro.emailaddress === employmail) { %>
      <section>
        <h2>Provider Details</h2>
        <p>Name: <%= pro.fullname %></p>
        <p>Contact: <%= pro.contactnumber %></p>
        <p>Email: <%= pro.emailaddress %></p>
        <img src="<%= pro.uploadimage?.url %>" alt="Provider Image">

        <% const matchedRequests = request.filter(req => req.emailaddress === pro.emailaddress); %>
        <% if (matchedRequests.length > 0) { %>
          <h3>Request Details</h3>
          <% for (let req of matchedRequests) { %>
            <p>Username: <%= req.usernames %></p>
            <p>Address: <%= req.useraddress %></p>
            <p>Service: <%= req.userservice %></p>
            <a href="/employlogin/<%= employmail %>/<%=req._id%>?action=accept">Accept</a>
            <a href="/employlogin/<%= employmail %>/<%=req._id%>/?action=reject">Reject</a>
          <% } %>
        <% } else { %>
          <p>No matching requests for this provider.</p>
        <% } %>
      </section>
    <% } %>
  <% } %>
</body>
</html>
